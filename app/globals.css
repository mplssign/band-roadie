@tailwind base;
@tailwind components;
@tailwind utilities;

/* Drawer surface "one shade lighter" */
.br-drawer-surface {
  background: color-mix(in oklab, hsl(var(--popover)) 88%, white);
  border-top: 1px solid hsl(var(--border));
}

[data-theme="dark"] .br-drawer-surface {
  background: color-mix(in oklab, hsl(var(--popover)) 92%, white);
}

/* Song card solid rendering for swipe actions */
.song-card {
  backface-visibility: hidden;
}

/* Hide scrollbar for horizontal scrolling */
.scrollbar-none::-webkit-scrollbar {
  display: none;
}

.scrollbar-none {
  -ms-overflow-style: none;
  scrollbar-width: none;
}

/* Song card pressed state - lighter overlay for contrast against black background */
.song-card::after {
  content: '';
  position: absolute;
  inset: 0;
  background: rgba(255, 255, 255, 0);  /* off by default */
  pointer-events: none;
  transition: opacity 120ms ease-out;
  opacity: 0;
}

/* Lighten effect: subtle white wash that works in light & dark themes */
.song-card[data-pressed="true"]::after {
  background: rgba(255, 255, 255, 0.08); /* tune 0.06â€“0.12 as needed */
  opacity: 1;
}

@property --angle {
  syntax: '<angle>';
  inherits: false;
  initial-value: 0deg;
}

@keyframes spin {
  to { --angle: 360deg; }
}

.animate-gradient-slow { animation: spin 12s linear infinite; }
.animate-gradient-med { animation: spin 8s linear infinite; }
.animate-gradient-fast { animation: spin 5s linear infinite; }
.animate-gradient-slower { animation: spin 15s linear infinite; }
.animate-gradient-faster { animation: spin 4s linear infinite; }
.animate-gradient-11s { animation: spin 11s linear infinite; }
.animate-gradient-9s { animation: spin 9s linear infinite; }
.animate-gradient-7s { animation: spin 7s linear infinite; }
.animate-gradient-6s { animation: spin 6s linear infinite; }

@layer base {
  :root {
    --background: 10 10 10;
    --foreground: 250 250 250;
    --card: 20 20 20;
    --card-foreground: 250 250 250;
    --popover: 20 20 20;
    --popover-foreground: 250 250 250;
    --primary: 220 38 38;
    --primary-foreground: 250 250 250;
    --secondary: 38 38 38;
    --secondary-foreground: 250 250 250;
    --muted: 38 38 38;
    --muted-foreground: 163 163 163;
    --accent: 220 38 38;
    --accent-foreground: 250 250 250;
    --destructive: 127 29 29;
    --destructive-foreground: 250 250 250;
    --border: 38 38 38;
    --input: 38 38 38;
    --ring: 220 38 38;
  }

  * {
    @apply border-border;
  }

  html {
    @apply bg-background text-foreground;
  }

  body {
    @apply bg-background text-foreground;
    font-feature-settings: "rlig" 1, "calt" 1;
    /* Prevent rubber-band scroll on iOS */
    overscroll-behavior: none;
  }
}

/* PWA Safe Area & Fullscreen Utilities */
@layer utilities {
  /* Use dvh (dynamic viewport height) for mobile fullscreen */
  .min-h-dvh {
    min-height: 100dvh;
  }
  
  .h-dvh {
    height: 100dvh;
  }

  /* Safe area padding utilities */
  .pt-safe {
    padding-top: env(safe-area-inset-top);
  }
  
  .pb-safe {
    padding-bottom: env(safe-area-inset-bottom);
  }
  
  .pl-safe {
    padding-left: env(safe-area-inset-left);
  }
  
  .pr-safe {
    padding-right: env(safe-area-inset-right);
  }
  
  .px-safe {
    padding-left: env(safe-area-inset-left);
    padding-right: env(safe-area-inset-right);
  }
  
  .py-safe {
    padding-top: env(safe-area-inset-top);
    padding-bottom: env(safe-area-inset-bottom);
  }

  /* Prevent content from being hidden by iOS notch/home indicator */
  .safe-top {
    top: env(safe-area-inset-top);
  }

  .safe-bottom {
    bottom: env(safe-area-inset-bottom);
  }

  /* PWA fullscreen container */
  .pwa-container {
    min-height: 100dvh;
    padding-top: env(safe-area-inset-top);
    padding-bottom: env(safe-area-inset-bottom);
  }

  /* Text truncation utilities */
  .line-clamp-2 {
    display: -webkit-box;
    line-clamp: 2;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
  }

  /* Scrollbar utilities */
  .no-scrollbar, 
  .scrollbar-hide,
  *[style*="scrollbar-width: none"] {
    -ms-overflow-style: none;
    scrollbar-width: none;
  }
  
  .no-scrollbar::-webkit-scrollbar, 
  .scrollbar-hide::-webkit-scrollbar,
  *[style*="scrollbar-width: none"]::-webkit-scrollbar {
    display: none !important;
    width: 0 !important;
    height: 0 !important;
    background: transparent !important;
  }

  /* PWA install prompt */
  .pwa-install-prompt {
    @apply fixed bottom-20 left-4 right-4 z-50 bg-card p-4 rounded-lg shadow-lg;
  }

  .animate-spin {
    animation: spin 1s linear infinite;
  }

  .animate-gradient-border {
    position: relative;
    padding: 2px;
    border-radius: 0.75rem;
    background: conic-gradient(from 0deg, #dc2626, #7c3aed, #2563eb, #dc2626);
    animation: gradient-spin var(--grad-speed, 3s) linear infinite;
  }

  .animate-gradient-border::before {
    content: '';
    position: absolute;
    inset: 2px;
    background: #18181b;
    border-radius: calc(0.75rem - 2px);
    z-index: 1;
  }

  .animate-gradient-border > * {
    position: relative;
    z-index: 2;
    background: transparent;
  }
}

@keyframes gradient-spin {
  0% {
    transform: rotate(0deg);
  }
  100% {
    transform: rotate(360deg);
  }
}

/* Rose-Violet animated gradient border variant */
.animate-gradient-border-rose-violet {
  position: relative;
  padding: 2px;
  border-radius: 0.75rem;
  background: conic-gradient(from 0deg, #F43F5E, #9333EA, #F43F5E);
  animation: gradient-spin var(--grad-speed, 3s) linear infinite;
}

.animate-gradient-border-rose-violet::before {
  content: '';
  position: absolute;
  inset: 2px;
  background: #18181b;
  border-radius: calc(0.75rem - 2px);
  z-index: 1;
}

.animate-gradient-border-rose-violet > * {
  position: relative;
  z-index: 2;
  background: transparent;
}

/* Background gradient utilities */
.bg-gradient-gig {
  background-image: linear-gradient(135deg, #F43F5E, #EAB308);
}

.bg-gradient-rehearsal {
  background-image: linear-gradient(135deg, #2563EB, #9333EA);
}

/* Disable animations for users who prefer reduced motion */
@media (prefers-reduced-motion: reduce) {
  .animate-gradient-border,
  .animate-gradient-border-rose-violet {
    animation: none !important;
  }
}

.drawer-backdrop {
  @apply fixed inset-0 bg-black/50 backdrop-blur-sm z-40;
}

.drawer-left {
  @apply fixed left-0 top-0 h-full w-80 bg-card border-r border-border shadow-xl z-50;
}

.drawer-right {
  @apply fixed right-0 top-0 h-full w-80 bg-card border-l border-border shadow-xl z-50;
}

@media (min-width: 768px) {
  ::-webkit-scrollbar {
    width: 8px;
    height: 8px;
  }

  ::-webkit-scrollbar-track {
    @apply bg-secondary;
  }

  ::-webkit-scrollbar-thumb {
    @apply bg-muted-foreground rounded;
  }

  ::-webkit-scrollbar-thumb:hover {
    @apply bg-foreground;
  }
}
